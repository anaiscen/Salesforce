const nodemailer = require("nodemailer");

function sendEmail(email, firstname, token) {
  const transporter = nodemailer.createTransport({
    host: "smtp-relay.sendinblue.com",
    port: 587,
    secure: false,
    tls: { rejectUnauthorized: false },
    auth: {
      user: process.env.EMAIL_USER,
      pass: process.env.EMAIL_PASS,
    },
  });

  const mailOptions = {
    from: "salesforce.ideation.plateforme@gmail.com",
    to: email,
    subject: "Réinitialiser mot de passe",
    html: `<p>Bonjour ${firstname}, <br> <br> Une demande de modification de votre mot de passe a été effectuée. <br>
    Si vous n'avez pas effectué cette demande, veuillez ignorer cet e-mail. <br>
    Sinon, veuillez cliquer sur le lien suivant pour changer votre mot de passe : 
    <a href="http://localhost:5173/setNewPassword/${token}">Cliquez sur ce lien</a><br><br> 
    Cordialement,<br><br>
    
    <img style='display:block; width:144px;height:144px;' id='base64image'
    src='data:image/png;base64,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' />
    </p>`,
  };
  // eslint-disable-next-line func-names
  try {
    transporter.sendMail(mailOptions);
  } catch (err) {
    console.warn(err);
  }
}

module.exports = {
  sendEmail,
};
